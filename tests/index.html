<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<script src="../src/promise.js"></script>
</head>
<body>

	<script>
		/*
		var p = new Promise();
		p.then(function(value){
			console.dir('fulfilled with value:');
			console.dir(value);
		}, function(reason){
			console.dir('rejected with reason:');
			console.dir(reason);
		});

		setTimeout(function(){
			setTimeout(function(){

				var r = Math.random() * 1000;

				if(r > 500)
				{
					p.fulfill(r);
				}
				else
				{
					p.reject(r);
				}
			}, 1000);
		}, 1000);
		*/

		var p1 = new Promise();

		p1.then(function(cnt){

			var p = new Promise();

			setTimeout(function(){
				console.dir(cnt);
				p.resolve(cnt + 1);
			}, 1000);

			return p;

		}).then(function(cnt){

			var p = new Promise();

			setTimeout(function(){
				console.dir(cnt);

				var heads = Math.random() * 1000 > 500;

				if(heads)
				{
					p.reject('i`ve chosen tails :(');
				}
				else
				{
					p.resolve(cnt + 1);
				}

			}, 1000);

			return p;

		}).then(function(cnt){

			var p = new Promise();

			setTimeout(function(){
				console.dir(cnt);
				p.resolve(cnt + 1);
			}, 1000);

			return p;
		}, function(reason){

			console.dir('interrupted: '+reason);

		});

		p1.resolve(1);

	</script>

</body>
</html>